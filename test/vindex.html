<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Wikipedia Recent Changes - U:Suyash.dwivedi</title>

  <!-- ‚úÖ SEO Meta Tags -->
  <meta name="description" content="Track Wikipedia Recent Changes across 42 languages with speech alerts, dark mode, and time-based filters. Created by Wikimedian Suyash Dwivedi.">
  <meta name="keywords" content="Wikipedia recent changes, multilingual RC, Wikimedian tool, live Wikipedia monitor, Suyash Dwivedi, Wikimedia tools">
  <meta name="author" content="Suyash Dwivedi">

  <!-- ‚úÖ Open Graph Meta -->
  <meta property="og:title" content="Wikipedia Recent Changes by Suyash Dwivedi">
  <meta property="og:description" content="Live Wikipedia edit monitor with voice alerts. Dark mode and multilingual support included.">
  <meta property="og:image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9c/Suyash_Dwivedi_01%28cropped%29.jpg/180px-Suyash_Dwivedi_01%28cropped%29.jpg">
  <meta property="og:url" content="https://suyashdwivedi.github.io/">
  <meta property="og:type" content="website">

  <!-- ‚úÖ Twitter Card -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Wikipedia RC Monitor ‚Äì by Suyash Dwivedi">
  <meta name="twitter:description" content="Listen to Wikipedia edits with speech alerts in multiple languages.">
  <meta name="twitter:image" content="https://upload.wikimedia.org/wikipedia/commons/thumb/9/9c/Suyash_Dwivedi_01%28cropped%29.jpg/180px-Suyash_Dwivedi_01%28cropped%29.jpg">

  <!-- ‚úÖ Favicon and Theme -->
  <link rel="icon" href="https://upload.wikimedia.org/wikipedia/commons/8/80/Wikipedia-logo-v2.svg" type="image/svg+xml" />
  <meta name="theme-color" content="#4CAF50" />

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      transition: background 0.3s, color 0.3s;
    }
    header, footer {
      padding: 10px;
      background-color: #f4f4f4;
      text-align: center;
      position: relative;
    }
    header img {
      position: absolute;
      top: 10px;
      left: 10px;
      width: 90px;
    }
    @media (max-width: 600px) {
      header img {
        display: none;
      }
    }
    .change-item {
      padding: 10px;
      border-bottom: 1px solid #ccc;
    }
    .date-time {
      text-align: center;
      font-size: 18px;
      font-weight: bold;
      color: green;
    }
    #toggle-theme, #voice-toggle {
      position: absolute;
      top: 10px;
      padding: 6px 12px;
      border: none;
      border-radius: 18px;
      cursor: pointer;
      z-index: 10;
    }
    #toggle-theme {
      right: 10px;
      background: #222;
      color: #ffd700;
    }
    #voice-toggle {
      right: 120px;
      background: #007BFF;
      color: white;
    }
    .nav-buttons {
      position: fixed;
      bottom: 20px;
      right: 20px;
      z-index: 10;
    }
    .nav-button {
      margin: 5px;
      padding: 10px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    body.dark-mode {
      background-color: #1a1a1a;
      color: #f0f0f0;
    }
    body.dark-mode header,
    body.dark-mode footer {
      background-color: #121212;
    }
    body.dark-mode .change-item {
      background-color: #2a2a2a;
      border-color: #444;
    }
  </style>
</head>
<body>

  <header>
    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/80/Wikipedia-logo-v2.svg/263px-Wikipedia-logo-v2.svg.png" alt="Wikipedia Logo">
    <button id="toggle-theme">üåô Dark Mode</button>
    <button id="voice-toggle">üîä Voice: On</button>
    <h1>Wikipedia Recent Changes</h1>
    <p>Created by <a href="https://meta.wikimedia.org/wiki/User:Suyash.dwivedi" target="_blank">Suyash Dwivedi</a> (in 42 languages)</p>
    <label for="language-select">Select Language: </label>
    <select id="language-select">
      <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä (Hindi)</option>
      <option value="en">English</option>
      <option value="gu">‡™ó‡´Å‡™ú‡™∞‡™æ‡™§‡´Ä (Gujarati)</option>
      <option value="pa">‡®™‡©∞‡®ú‡®æ‡®¨‡©Ä (Punjabi)</option>
      <option value="fr">Fran√ßais (French)</option>
      <option value="de">Deutsch (German)</option>
      <option value="es">Espa√±ol (Spanish)</option>
      <option value="it">Italiano (Italian)</option>
      <option value="ru">–†—É—Å—Å–∫–∏–π (Russian)</option>
    </select>
  </header>

  <div id="date-time" class="date-time"></div>
  <div id="counter">Changes Count: 0</div>
  <div id="changes"></div>

  <footer>
    Created by <a href="https://meta.wikimedia.org/wiki/User:Suyash.dwivedi" target="_blank">Suyash Dwivedi</a> |
    Updated on: 22 July 2025
  </footer>

  <div class="nav-buttons">
    <button class="nav-button" onclick="window.scrollTo({ top: 0, behavior: 'smooth' })">Go to Top</button>
    <button class="nav-button" onclick="window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' })">Go to Bottom</button>
  </div>

<script>
const changesDiv = document.getElementById('changes');
const dateDisplay = document.getElementById('date-time');
const languageSelect = document.getElementById('language-select');

let changeCount = 0;
let spokenTimestamps = new Set();
let voiceEnabled = localStorage.getItem('voiceEnabled') !== 'false';

const langMap = {
  en: 'en-US', hi: 'hi-IN', gu: 'gu-IN', pa: 'pa-IN',
  fr: 'fr-FR', de: 'de-DE', es: 'es-ES', it: 'it-IT', ru: 'ru-RU'
};

function displayDateTime() {
  const now = new Date();
  dateDisplay.innerHTML = `Date: ${now.toLocaleString(undefined, {
    hour12: true,
    year: 'numeric',
    month: 'long',
    day: 'numeric',
    weekday: 'long',
    hour: '2-digit',
    minute: '2-digit',
    second: '2-digit'
  })}`;
}

function isIPAddress(user) {
  return /^(\d{1,3}\.){3}\d{1,3}$/.test(user) || /^[a-fA-F0-9:]+$/.test(user);
}

function speak(text, lang) {
  if (!voiceEnabled) return;
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = langMap[lang] || 'en-US';
  speechSynthesis.speak(utterance);
}

function displayChanges(changes, language) {
  changesDiv.innerHTML = '';
  changes.sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));

  changes.forEach((change) => {
    const ts = change.timestamp;
    const changeTime = new Date(ts);

    const div = document.createElement('div');
    div.className = 'change-item';
    div.innerHTML = `
      <strong>Page Changed:</strong> <a href="https://${language}.wikipedia.org/w/index.php?title=${encodeURIComponent(change.title)}&action=history" target="_blank">${change.title}</a><br>
      <strong>Editor:</strong> <a href="https://${language}.wikipedia.org/wiki/Special:Contributions/${encodeURIComponent(change.user)}" target="_blank">${change.user || 'Anonymous'}</a><br>
      <strong>Time (Local):</strong> ${changeTime.toLocaleString()}<br>
      <strong>Comment:</strong> ${change.comment || 'No summary'}<br>
    `;
    changesDiv.appendChild(div);

    if (!spokenTimestamps.has(ts)) {
      let speech = `Page Changed: ${change.title}. `;
      if (!change.user) {
        speech += "Edited by anonymous.";
      } else if (isIPAddress(change.user)) {
        speech += "Edited by IP address.";
      } else {
        speech += `Editor: ${change.user}.`;
      }
      speak(speech, language);
      spokenTimestamps.add(ts);
      changeCount++;
    }
  });

  document.getElementById('counter').innerText = `Changes Count: ${changeCount}`;
}

async function fetchChanges(lang) {
  try {
    const res = await fetch(`https://${lang}.wikipedia.org/w/api.php?action=query&list=recentchanges&rcprop=title|user|timestamp|comment&rclimit=50&origin=*&format=json`);
    const data = await res.json();
    displayChanges(data.query.recentchanges, lang);
  } catch (e) {
    console.error("Fetch error:", e);
  }
}

// Init logic
displayDateTime();
setInterval(displayDateTime, 1000);

// Theme init
if (localStorage.getItem('theme') === 'dark') {
  document.body.classList.add('dark-mode');
  document.getElementById('toggle-theme').textContent = '‚òÄÔ∏è Light Mode';
}

document.getElementById('toggle-theme').onclick = () => {
  document.body.classList.toggle('dark-mode');
  const isDark = document.body.classList.contains('dark-mode');
  localStorage.setItem('theme', isDark ? 'dark' : 'light');
  document.getElementById('toggle-theme').textContent = isDark ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';
};

// Voice toggle
function updateVoiceLabel() {
  document.getElementById('voice-toggle').textContent = voiceEnabled ? 'üîä Voice: On' : 'üîá Voice: Off';
}
updateVoiceLabel();
document.getElementById('voice-toggle').onclick = () => {
  voiceEnabled = !voiceEnabled;
  localStorage.setItem('voiceEnabled', voiceEnabled);
  updateVoiceLabel();
};

// Init fetch and polling
const lang = localStorage.getItem('selectedLanguage') || 'hi';
languageSelect.value = lang;
fetchChanges(lang);
setInterval(() => fetchChanges(languageSelect.value), 10000);

languageSelect.addEventListener('change', () => {
  const newLang = languageSelect.value;
  localStorage.setItem('selectedLanguage', newLang);
  spokenTimestamps.clear();
  changeCount = 0;
  fetchChanges(newLang);
});
</script>

<!-- ‚úÖ Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GC8PGC89NB"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-GC8PGC89NB');
</script>

<!-- ‚úÖ Counter.dev -->
<script src="https://cdn.counter.dev/script.js"
    data-id="cc7a036d-a904-4d76-bcac-37ea4196c014"
    data-utcoffset="6"></script>

</body>
</html>
